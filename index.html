<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Politie Academie - Taaltraining & Evaluatie</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCJ5of6K5MRFXMOiEqEyZxZbs1xoJtXuN8",
            authDomain: "pvaangifteinleveren.firebaseapp.com",
            databaseURL: "https://pvaangifteinleveren-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "pvaangifteinleveren",
            storageBucket: "pvaangifteinleveren.firebasestorage.app",
            messagingSenderId: "989190242332",
            appId: "1:989190242332:web:867ea95845325cf9835fd9"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // --- STUDENT FUNCTIES ---
        window.saveWork = function() {
            const className = document.getElementById('selectedClass').value;
            const studentName = document.getElementById('studentName').value;
            const ownSentence = document.getElementById('ownSentence').value;
            const q1 = document.getElementById('q1').value.trim();
            const q2 = document.getElementById('q2').value.trim();
            
            if(!className || !studentName || !ownSentence) {
                alert("Let op: Vul klas, naam en je eigen zinnen in.");
                return;
            }

            const studentRef = ref(db, 'lessen/' + className);
            push(studentRef, {
                student: studentName,
                q1: q1,
                q2: q2,
                sentence: ownSentence,
                time: new Date().toLocaleTimeString()
            }).then(() => {
                alert("Ingevuld materiaal is verzonden naar de database.");
                document.getElementById('studentName').value = "";
                document.getElementById('ownSentence').value = "";
                document.getElementById('q1').value = "";
                document.getElementById('q2').value = "";
            });
        };

        // --- DOCENT FUNCTIES ---
        let activeClass = "";

        window.loadClassResults = function(className) {
            activeClass = className;
            const resultsDiv = document.getElementById('results-display');
            const adminTitle = document.getElementById('admin-title');
            const resetBtn = document.getElementById('reset-btn-container');
            
            adminTitle.innerText = "Overzicht Klas: " + className;
            resultsDiv.innerHTML = "Gegevens ophalen...";
            
            const classRef = ref(db, 'lessen/' + className);
            onValue(classRef, (snapshot) => {
                const data = snapshot.val();
                resultsDiv.innerHTML = "";
                
                if(!data) {
                    resultsDiv.innerHTML = "<p>Geen studentenwerk gevonden voor deze klas.</p>";
                    resetBtn.style.display = "none";
                    return;
                }

                resetBtn.style.display = "block";
                for(let id in data) {
                    const res = data[id];
                    const isCorrect1 = res.q1.toLowerCase() === 'dan' ? '‚úÖ' : '‚ùå';
                    const isCorrect2 = res.q2.toLowerCase() === 'als' ? '‚úÖ' : '‚ùå';

                    resultsDiv.innerHTML += `
                        <div class="result-card">
                            <div class="result-header">
                                <strong>${res.student}</strong> <small>${res.time}</small>
                            </div>
                            <div class="result-body">
                                <strong>Quiz:</strong> 1: ${res.q1} ${isCorrect1} | 2: ${res.q2} ${isCorrect2}<br>
                                <strong>Eigen zinnen:</strong><br>
                                <span class="student-text">${res.sentence}</span>
                            </div>
                        </div>`;
                }
            });
        };

        window.hardResetClass = function() {
            if(!activeClass) return;
            
            const bevestiging = confirm(`WAARSCHUWING: Je staat op het punt ALLE ingeleverde producten van klas ${activeClass} definitief te verwijderen. Dit kan niet ongedaan worden gemaakt. Doorgaan?`);
            
            if(bevestiging) {
                const classRef = ref(db, 'lessen/' + activeClass);
                remove(classRef).then(() => {
                    alert(`Klas ${activeClass} is volledig gereset.`);
                }).catch((error) => {
                    alert("Fout bij verwijderen: " + error.message);
                });
            }
        };
    </script>
    <style>
        :root { --police-blue: #002344; --accent-gold: #f1c40f; --bg: #f4f7f9; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        .container { max-width: 900px; margin: auto; }
        .card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; border-top: 5px solid var(--police-blue); }
        h1, h2, h3 { color: var(--police-blue); margin-top: 0; }
        
        /* Input styling */
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px; }
        .btn-save { background: #27ae60; color: white; padding: 15px; border: none; width: 100%; border-radius: 4px; font-weight: bold; cursor: pointer; font-size: 18px; }
        .btn-save:hover { background: #219150; }

        /* Docent Nav */
        .nato-nav { display: flex; flex-wrap: wrap; gap: 8px; margin: 15px 0; }
        .nato-btn { flex: 1; min-width: 100px; padding: 10px; background: var(--police-blue); color: white; border: none; cursor: pointer; border-radius: 4px; font-weight: bold; }
        .nato-btn:hover { background: var(--accent-gold); color: var(--police-blue); }

        /* Resultaten */
        .result-card { border-left: 4px solid var(--accent-gold); background: #f9f9f9; padding: 15px; margin-bottom: 10px; border-radius: 0 4px 4px 0; }
        .result-header { border-bottom: 1px solid #ddd; padding-bottom: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .student-text { color: #2c3e50; font-style: italic; white-space: pre-wrap; }

        /* Reset knop */
        .btn-reset { background: #c0392b; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .btn-reset:hover { background: #a93226; }
        #reset-btn-container { display: none; text-align: right; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <h1>üöî Politieschool: Taaltraining</h1>
        <p>Focus: Bijvoeglijke naamwoorden, <em>Als</em> (stellend) vs. <em>Dan</em> (overtreffend).</p>
    </div>

    <div class="card">
        <h3>1. Inleveren student</h3>
        <select id="selectedClass">
            <option value="">Kies je klas (Nato)...</option>
            <option value="Delta">Klas D (Delta)</option>
            <option value="Echo">Klas E (Echo)</option>
            <option value="Foxtrot">Klas F (Foxtrot)</option>
            <option value="Lima">Klas L (Lima)</option>
            <option value="Mike">Klas M (Mike)</option>
        </select>
        <input type="text" id="studentName" placeholder="Volledige naam">
        
        <p><strong>Vraag A:</strong> De verdachte rende harder ____ de agent.</p>
        <input type="text" id="q1" placeholder="als of dan?">
        
        <p><strong>Vraag B:</strong> De getuige was even betrouwbaar ____ de camerabeelden.</p>
        <input type="text" id="q2" placeholder="als of dan?">

        <p><strong>2. Eigen voorbeeldzinnen (voor de bespreking):</strong></p>
        <textarea id="ownSentence" rows="4" placeholder="Schrijf hier je eigen zinnen waarin je een vergelijking maakt tussen personen of situaties..."></textarea>
        
        <button class="btn-save" onclick="saveWork()">WERK OPSLAAN</button>
    </div>

    <div class="card" style="border-top-color: var(--accent-gold);">
        <h2 id="admin-title">Docentenpaneel</h2>
        <p>Selecteer een klas om de producten live in te laden:</p>
        <div class="nato-nav">
            <button class="nato-btn" onclick="loadClassResults('Delta')">DELTA</button>
            <button class="nato-btn" onclick="loadClassResults('Echo')">ECHO</button>
            <button class="nato-btn" onclick="loadClassResults('Foxtrot')">FOXTROT</button>
            <button class="nato-btn" onclick="loadClassResults('Lima')">LIMA</button>
            <button class="nato-btn" onclick="loadClassResults('Mike')">MIKE</button>
        </div>

        <div id="results-display">
            <i>Klik op een klasnaam om de inzendingen te bekijken.</i>
        </div>

        <div id="reset-btn-container">
            <button class="btn-reset" onclick="hardResetClass()">‚ö†Ô∏è KLAS VOLLEDIG RESETTEN</button>
        </div>
    </div>
</div>

</body>
</html>
